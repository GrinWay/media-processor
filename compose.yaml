networks:
  default:
    name: 'app'
    driver: 'bridge'

services:
  php-fpm:
    container_name: '${APP_DOCKER_CONTAINER_PREFIX}-php-fpm'
    restart: 'unless-stopped'
    build:
      context: '.'
      dockerfile: './docker/php-fpm/Dockerfile'
      args:
        PUID: ${PUID}
        PGID: ${PGID}
    volumes:
    - '.:/var/www:rw'

  nginx:
    container_name: '${APP_DOCKER_CONTAINER_PREFIX}-nginx'
    restart: 'unless-stopped'
    build:
      context: '.'
      dockerfile: './docker/nginx/Dockerfile'
      args:
        APP_DOCKER_CONTAINER_PREFIX: ${APP_DOCKER_CONTAINER_PREFIX}
    ports:
    - '${APP_NGINX_HOST_HTTP_PORT}:80'
    - '${APP_NGINX_HOST_HTTPS_PORT}:443'
    volumes:
    - '.:/var/www:rw'
    depends_on:
    - 'php-fpm'
